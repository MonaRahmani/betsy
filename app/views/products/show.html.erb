<!--Product details-->
<!--add form-->
<!--to add item to car-->
<%= form_with model: @order_item, url: product_order_items_path(@product.id) do |f| %>
  <h1><%= @product.name %></h1>
  <%= image_tag( @product.photo_url) %>
  <br>
  Description: <%= @product.description %>
  <br>
  <%= number_to_currency(@product.price) %>
  <br>
  Sold by: <%= link_to @product.user.username, user_products_path(@product.user.id) %>
  <% if @product.stock == 0 %> <br>
    Out of Stock!
  <% elsif @product.stock < 5 %> <br>
    Almost out of Stock!
  <% end %> <br>
  <%= f.label :quantity %>
  <%= f.text_field :quantity, :required => true%>

  <h4>Category: </h4>
  <% @product.categories.each do |category| %>
    <%= link_to category.category_name, category_products_path(category.id) %>
  <% end %>
<%#= @product.retired %>
  <br>
  <%= link_to "Back", products_path %>

  <%= f.submit "Add to Cart" %>
<% end %>

<div>
  <section class='reviews'>
    <h2>Review and Rating</h2>
    <h5>Average Rating: <%= @product.average_rating %> out of <%= @reviews.length %> Reviews </h5>
    <%= render partial: "reviews/rating", locals: { action_name: "Submit Review", product: @product } %>
    <% if @reviews.length != 0 %>
      <ul class="review-list">
        <% @reviews.each do |review| %>
          <li>
            <strong>
              <%= review.created_at %> - Rating: <%= review.rating %> - Review by: <%= review.name %>
            </strong>
          </li>
          <ul class="review-item"><li><%= review.review_content %></li></ul>
        <% end %>
      </ul>
    <% end %>
  </section>
</div>