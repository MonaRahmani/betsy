
<body>
  <%= form_with model: @order_item, url: product_order_items_path(@product.id) do |f| %>
    <h1><%= @product.name %></h1>
    <div class="product-details-page">
      <%= image_tag( @product.photo_url, :size => '300x350') %>
      <div>
        <br>
        <div class="product-details">
          CATEGORY: <% @product.categories.each do |category| %>
            <%= link_to category.category_name, category_products_path(category.id) %>
          <% end %>
          DESCRIPTION: <%= @product.description %>
        <br>
          <%= number_to_currency(@product.price) %>
        <br>
         SOLD BY: <%= link_to @product.user.username, user_products_path(@product.id) %>
          <% if @product.stock == 0 %>
            <br>
            Out of Stock!
          <% elsif @product.stock < 5 %>
            <br>
            Almost out of Stock!
          <% end %>
        </div>
        <br>
        <div class="product-detail-fields">
          <%= f.label :quantity %>
          <%= f.number_field :quantity, in: 1..100 %>
           <br>
          <%= f.submit "Add to Cart", class:"add-to-cart" %>
            <br>
          <%= link_to "Back", products_path, class:'back-button' %>
        </div>
      </div>
    </div>

    <div>
      <section class='reviews'>
        <h4>REVIEW AND RATINGS</h4>
        <h5>AVERAGE RATING: <%= @product.average_rating %> out of <%= @reviews.length %> reviews </h5>
        <%= render partial: "reviews/rating", locals: { action_name: "Submit Review", product: @product } %>
        <% if @reviews.length != 0 %>
          <ul class="review-list">
            <% @reviews.each do |review| %>
              <li>
                <strong>
                  <%= review.created_at %> - Rating: <%= review.rating %> - Review by: <%= review.name %>
                </strong>
              </li>
              <ul class="review-item"><li><%= review.review_content %></li></ul>
            <% end %>
          </ul>
        <% end %>
      </section>
    </div>
<% end %>
</body>
